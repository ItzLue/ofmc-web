Protocol: EPMO # Attack \n# Early version of an E-Payment protocol from a paper of Joshua Guttman\n\nTypes: Agent B,C,M;\n       Number NC,NM,NB,Goods,Price,one,two,three,four,five,six;\n       Function pk,hash\n\nKnowledge: B: B,C,M,pk,inv(pk(B)),hash,one,two,three,four,five,six;\n\t   C: B,C,M,pk,inv(pk(C)),hash,one,two,three,four,five,six;\n\t   M: B,C,M,pk,inv(pk(M)),hash,one,two,three,four,five,six\nwhere B!=C, B!=M, C!=M, B!=i\n\nActions:\n\nC -> M: one,{C,NC,Goods,Price}pk(M)\nM -> C: two,{NC,NM,M,Goods,Price}pk(C)\nC -> B: three,{C,NC,NM,Price}pk(B)\nB -> C: four,{hash(C,NC,NB,NM,Price)}inv(pk(B)),{NC,NB}pk(C)\nC -> M: five,{hash(C,NC,NB,NM,Price)}inv(pk(B)),NB\nM -> B: six,{hash(B,NB,NM)}inv(pk(M))\n\nGoals:\n\nM authenticates C on Goods,Price,B\nB authenticates C on Price,B,M\n\n\n"